<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ุงูุฐูุจ</title>
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>

<div class="container" id="app" style="display:none">

  <div class="brand">
    <div class="logo"></div>
    <div>
      <h1>๐ช ุชุฏุงูู ุงูุฐูุจ</h1>
      <p class="small">ุณุนุฑ ุงูุบุฑุงู: <b>135 ููุทุฉ</b></p>
    </div>
  </div>

  <!-- ุงูุฑุตูุฏ -->
  <div class="card">
    <h3>ุฑุตูุฏู</h3>
    <div id="balances">ุชุญููู...</div>
  </div>

  <!-- ุดุฑุงุก ุงูุฐูุจ -->
  <div class="card">
    <h3>๐ข ุดุฑุงุก ุฐูุจ</h3>
    <input id="buyPoints" type="number" placeholder="ุนุฏุฏ ุงูููุงุท">
    <div style="height:10px"></div>
    <button id="buyBtn" class="btn btn-primary">ุดุฑุงุก</button>
  </div>

  <!-- ุจูุน ุงูุฐูุจ -->
  <div class="card">
    <h3>๐ด ุจูุน ุฐูุจ</h3>
    <input id="sellGrams" type="number" step="0.01" placeholder="ุนุฏุฏ ุงูุบุฑุงูุงุช">
    <div style="height:10px"></div>
    <button id="sellBtn" class="btn btn-danger">ุจูุน</button>
  </div>

  <!-- ุณุฌู ุงูุนูููุงุช -->
  <div class="card">
    <h3>๐ ุณุฌู ูุนุงููุงุช ุงูุฐูุจ</h3>
    <div id="history">ุชุญููู...</div>
  </div>

</div>

<!-- ุดุฑูุท ุงูุชููู -->
<nav class="bottom-nav">
  <div class="nav-wrap">
    <a class="nav-item" href="dashboard.html">๐<div>ุงูุฑุฆูุณูุฉ</div></a>
    <a class="nav-item active" href="gold.html">๐ช<div>ุงูุฐูุจ</div></a>
    <a class="nav-item" href="wallet.html">๐<div>ูุญูุธุชู</div></a>
    <a class="nav-item" href="profile.html">๐ค<div>ุงูููู ุงูุดุฎุตู</div></a>
  </div>
</nav>

<script type="module">
import { supabase } from "./assets/supabaseClient.js";

const GOLD_PRICE = 135;
const MIN_ACTIVATION = 500;

/* =====================
   ุชุญูู ุชุณุฌูู ุงูุฏุฎูู
===================== */
const { data: { user } } = await supabase.auth.getUser();
if (!user) location.href = "login.html";

/* =====================
   ููู ุงูุฐูุจ ุญุชู 500$ ุฃู ุชูุนูู ุงูุฃุฏูู
===================== */
const { data: walletCheck } = await supabase
  .from("wallets")
  .select("points, gold_enabled")
  .eq("user_id", user.id)
  .single();

if (
  !walletCheck ||
  (!walletCheck.gold_enabled && walletCheck.points < MIN_ACTIVATION)
) {
  document.body.innerHTML = `
    <div style="
      max-width:420px;
      margin:80px auto;
      background:#111;
      padding:20px;
      border-radius:14px;
      text-align:center;
      color:#fff
    ">
      <h2>๐ ุงูุฐูุจ ูููู</h2>
      <p style="opacity:.85">
        ูุฌุจ ุดุญู <b>500 ุฏููุงุฑ</b> ุฃู ุงูุชุธุงุฑ ุชูุนูู ุงูุฃุฏูู
      </p>
      <a href="wallet.html"
         style="
           display:inline-block;
           margin-top:15px;
           padding:10px
